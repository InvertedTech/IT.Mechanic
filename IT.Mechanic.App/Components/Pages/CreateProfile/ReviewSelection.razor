@using IT.Mechanic.App.Services.Profiles
@using IT.Mechanic.App.Services.Settings
@using IT.Mechanic.Models.Configuration
@using IT.Mechanic.Models.Configuration.App
@using IT.Mechanic.Models.Configuration.Credentials
@page "/create/review-selection"
@inject IProfileFactory ProfileFactory;
@inject ICredentialService CredentialService;
@inject IProfileService ProfileService;
@inject NavigationManager Navigation;

<MudPaper Width="300">
    <MudCard Elevation="20" Class="ml-auto mr-auto">
        <MudCardHeader>
            <MudText Typo="Typo.h4">Review Selections</MudText>
        </MudCardHeader>
        <MudCardContent>
            <MudStack>
                <MudStack Row="true">
                    <MudText Typo="Typo.subtitle1">Website Type:</MudText>
                    <MudTextField Value="ProfileFactory.ProductSelection.WebsiteType" Disabled="true" />
                </MudStack>
            </MudStack>
            <MudStack>
                <MudStack Row="true">
                    <MudText Typo="Typo.subtitle1">Domain Name:</MudText>
                    <MudTextField Value="ProfileFactory.DNS.DomainName" Disabled="true"/>
                </MudStack>
                <MudStack Row="true">
                    <MudText Typo="Typo.subtitle1">DNS Provider:</MudText>
                    <MudTextField Value="ProfileFactory.DNS.Provider" Disabled="true" />
                </MudStack>
            </MudStack>
            <MudStack>
                <MudStack Row="true">
                    <MudText Typo="Typo.subtitle1">Hosting Provider:</MudText>
                    <MudTextField Value="ProfileFactory.Server.HostingProvider" Disabled="true" />
                </MudStack>
                <MudStack Row="true">
                    <MudText Typo="Typo.subtitle1">Server Name:</MudText>
                    <MudTextField Value="ProfileFactory.Server.ServerName" Disabled="true" />
                </MudStack>
                <MudStack Row="true">
                    <MudText Typo="Typo.subtitle1">Server User:</MudText>
                    <MudTextField Value="ProfileFactory.Server.User" Disabled="true" />
                </MudStack>
                @if (ProfileFactory.Server.HostingProvider == ServerModel.HostingProviderEnum.Expertmode)
                {
                    <MudStack Row="true">
                        <MudText Typo="Typo.subtitle1">Public IP:</MudText>
                        <MudTextField Value="ProfileFactory.Server.PublicIP" Disabled="true" />
                    </MudStack>

                    <MudStack Row="true">
                        <MudText Typo="Typo.subtitle1">SSH Private Key: </MudText>
                        <MudTextField Value="ProfileFactory.Server.User" Disabled="true" InputType="InputType.Password"/>
                    </MudStack>
                }
            </MudStack>
        </MudCardContent>
        <MudCardActions>
            <MudButtonGroup Variant="Variant.Filled">
                <MudButton Color="Color.Primary">Back</MudButton>
                <MudButton Color="Color.Secondary" @onclick="OnNextClicked">Next</MudButton>
            </MudButtonGroup>
        </MudCardActions>
    </MudCard>
</MudPaper>

@code {
    public async void OnNextClicked()
    {
        MainModel model = ProfileFactory.BuildProfile();
        await ProfileService.SaveModelAsync(model);
        Navigation.NavigateTo("/");
    }
}
